<?php

/**
 * @file
 * Bulk export of panels_layouts objects generated by Bulk export module.
 */

/**
 * Implements hook_default_panels_renderer_pipeline().
 */
function dpicache_default_panels_renderer_pipeline() {
  $pipelines = array();

  $pipeline = new stdClass;
  $pipeline->disabled = FALSE; /* Edit this to true to make a default pipeline disabled initially */
  $pipeline->api_version = 1;
  $pipeline->name = 'dpicacheesi';
  $pipeline->admin_title = t('DpiCache ESI');
  $pipeline->admin_description = t('Renders ESI-cached panels through ESI.');
  $pipeline->weight = -99;
  $pipeline->settings = array(
    'renderers' => array(
      0 => array(
          'access' => array(
              'plugins' => array(
                  0 => array(
                      'name' => 'dpicache_pipeline_renderer_access',
                      'settings' => array('pipeline' => 'dpicacheesi_ipe'),
                  ),
                // Add the permissions-check from the IPE pipeline.
                  1 => array(
                      'name' => 'perm',
                      'settings' => array(
                          'perm' => 'use panels in place editing',
                      ),
                      'context' => 'logged-in-user',
                  ),
              ),
              'logic' => 'and',
          ),
          'renderer' => 'dpicacheesi_ipe',
          'options' => array(),
      ),
      // Standard renderer.
        1 => array(
            'access' => array(
                'plugins' => array(
                    array(
                        'name' => 'dpicache_pipeline_renderer_access',
                        'settings' => array('pipeline' => 'dpicacheesi_standard'),
                    ),
                ),
            ),
            'renderer' => 'dpicacheesi_standard',

            'options' => array(),
      ),
    ),
  );
  $pipelines[$pipeline->name] = $pipeline;

  return $pipelines;
}
